# GitHub Actions CI for 4YP Assessment Timetable Scheduler
#
# Runs on every push and pull request to main/master.
# Three jobs:
#   lint   — ruff checks style and common errors
#   test   — pytest runs the full test suite
#   types  — pyright checks static types (same config as VS Code Pylance)

name: CI

on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]

jobs:
  lint:
    name: Lint (ruff)
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.12"

      - name: Install ruff
        run: pip install ruff>=0.6

      - name: Run ruff
        run: ruff check src/ tests/ main.py

  test:
    name: Tests (pytest)
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.12"

      - name: Install dependencies
        run: pip install -e ".[dev]"

      - name: Run pytest
        run: pytest tests/ -v --tb=short

  types:
    name: Type check (pyright)
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.12"

      - name: Install dependencies
        run: pip install -e ".[dev]" pyright

      - name: Run pyright
        run: pyright src/
